<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/pages.css" />
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
    <script type="module" src="assets/js/bootstrap.bundle.min.js"></script>
    <link
      href="https://fonts.googleapis.com/css?family=League Spartan"
      rel="stylesheet"
    />
    <script type="module" src="js/utils/utils.js" defer></script>
    <script type="module" src="js/system/inventory.js" defer></script>
    <title>Blood Inventory</title>
  </head>
  <style>
    /* Additional responsive styles */
    @media screen and (min-width: 1540px) {
      .fixed-sidebar {
        width: 300px !important;
      }
      .content-area {
        margin-left: 320px !important;
      }
      .inventory {
        width: 1215px !important;
      }
      .alerts {
        width: 270px !important;
      }
      .logout {
        margin-top: 170px !important;
      }
    }
    /* For medium devices (768px to 1024px, tablets, small laptops) */
    @media screen and (min-width: 1200px) and (max-width: 1400px) {
      .fixed-sidebar {
        width: 230px !important;
      }
      .content-area {
        margin-left: 230px !important;
      }
      .inventory {
        width: 830px !important;
      }
      .alerts {
        width: 267px !important;
      }
    }

    @media screen and (min-width: 768px) and (max-width: 1300px) {
      .fixed-sidebar {
        width: 210px !important;
      }
      .content-area {
        margin-left: 210px !important;
      }
      .inventory {
        width: 980px !important;
      }
      .alerts {
        width: 240px !important;
        margin-top: 20px !important;
      }
    }
  </style>
  <body>
    <div id="loader"></div>
    <div class="row" id="hide">
      <div class="col-2 fixed-sidebar shadow">
        <div class="text-center">
          <img src="assets/imgs/letterlogo.png" alt="" width="120px" />
        </div>
        <br />
        <div id="nav_loader"></div>
        <div class="d-none HospitalLink">
          <a href="dashboardH.html" class="nav-link d-flex opacity">
            <div class="ms-4 p-2">
              <img src="assets/icon/b-dashboard.png" alt="" width="18px" />
            </div>
            <span class="padding">Dashboard</span>
          </a>
        </div>
        <div class="d-none BCLink">
          <a href="dashboard.html" class="nav-link d-flex opacity">
            <div class="ms-4 p-2">
              <img src="assets/icon/b-dashboard.png" alt="" width="18px" />
            </div>
            <span class="padding">Dashboard</span>
          </a>
        </div>
        <div class="d-none BCLink HospitalLink">
          <a href="inventory.html " class="nav-link d-flex focus">
            <div class="ms-4 p-2">
              <img src="assets/icon/w-inventory.png" alt="" width="18px" />
            </div>
            <span class="padding">Inventory</span>
          </a>
        </div>
        <div class="d-none BCLink HospitalLink">
          <a href="reserveBlood.html" class="nav-link d-flex opacity">
            <div class="ms-4 p-2">
              <img src="assets/icon/b-inventory.png" alt="" width="18px" />
            </div>
            <span class="padding">Reserve Blood</span>
          </a>
        </div>
        <div class="d-none BCLink">
          <a href="event.html" class="nav-link d-flex opacity">
            <div class="ms-4 p-2">
              <img src="assets/icon/b-event.png" alt="" width="18px" />
            </div>
            <span class="padding">Events</span>
          </a>
        </div>
        <div class="d-none BCLink">
          <a
            href="request.html"
            class="nav-link d-flex position-relative opacity"
          >
            <div class="ms-4 p-2">
              <img
                src="assets/icon/b-request.png"
                alt="Request Icon"
                width="18px"
              />
              <span id="getTotalPendingRequest"></span>
              <span class="ms-2">Requests</span>
            </div>
          </a>
        </div>
        <div class="d-none BCLink">
          <a href="donor.html" class="nav-link d-flex opacity">
            <div class="ms-4 p-2">
              <img src="assets/icon/b-donor.png" alt="" width="18px" />
            </div>
            <span class="padding">Donors</span>
          </a>
        </div>
        <div class="d-none HospitalLink">
          <a href="bloodCenter.html" class="nav-link d-flex opacity">
            <div class="ms-4 p-2">
              <img src="assets/icon/map-marker-home.png" alt="" width="19px" />
            </div>
            <span class="padding">Blood Center</span>
          </a>
        </div>
        <div class="d-none HospitalLink">
          <a href="bloodRequest.html" class="nav-link d-flex opacity">
            <div class="ms-4 p-2">
              <img src="assets/icon/b-request.png" alt="" width="18px" />
            </div>
            <span class="padding">Requests</span>
          </a>
        </div>
        <div class="d-none BCLink HospitalLink">
          <a href="user.html" class="nav-link d-flex opacity">
            <div class="ms-4 p-2">
              <img src="assets/icon/b-users.png" alt="" width="18px" />
            </div>
            <span class="padding">Users</span>
          </a>
        </div>
        <div class="d-none BCLink HospitalLink">
          <a href="profile.html" class="nav-link d-flex opacity">
            <div class="ms-4 p-2">
              <img src="assets/icon/b-profile.png" alt="" width="20px" />
            </div>
            <span class="padding">Profile</span>
          </a>
        </div>
        <div class="d-none HospitalLink"><br /><br /></div>
        <br /><br /><br /><br /><br /><br /><br /><br />
        <!-- logout -->
        <div class="logout d-none BCLink HospitalLink">
          <span
            class="nav-link d-flex opacity ms-1"
            type="submit"
            id="btn_logout"
          >
            <div class="ms-4 p-2">
              <img src="assets/icon/logout.png" alt="" width="20px" />
              <span class="ms-1">Log out</span>
            </div>
          </span>

          <!-- logout -->
          <br /><br /><br />
        </div>
      </div>

      <div class="col-10 bg content-area">
        <div class="container-fluid mt-4">
          <h4 class="fw-bold">Blood Inventory</h4>
          <span>Manage blood supply</span>
          <br /><br />
          <button
            class="openbtn position-absolute end-0 top-0"
            type="button"
            data-bs-toggle="offcanvas"
            data-bs-target="#offcanvasRight"
            aria-controls="offcanvasRight"
          >
            <img src="assets/icon/time-past.png" width="25px" />
          </button>

          <div
            class="offcanvas offcanvas-end"
            tabindex="-1"
            id="offcanvasRight"
            aria-labelledby="offcanvasRightLabel"
          >
            <div class="offcanvas-header">
              <h5 class="offcanvas-title fw-bold" id="offcanvasRightLabel">
                History
              </h5>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="offcanvas"
                aria-label="Close"
                tabindex="-1"
              ></button>
            </div>
            <div class="offcanvas-body">
              <div id="stocksHistory"></div>
            </div>
          </div>
          <div class="row">
            <div
              class="col-10 bg-white p-3 ms-3 rounded-3 shadow-sm inventory"
              style="width: 950px; position: relative; height: fit-content"
            >
              <div class="d-flex">
                <span class="fw-bold font-size mt-1 mb-4">Manage blood</span>
                <div
                  class="d-flex bg-white dropdown3 p-2 rounded-3 shadow-sm"
                  style="right: 505px"
                >
                  <div>Sort by</div>
                  <div>
                    <select
                      class="form-select"
                      aria-label=""
                      style="
                        border: none !important;
                        padding: 0px 33px 0px 5px;
                        box-shadow: none;
                      "
                      id="sortComponent"
                    >
                      <option selected disabled>Component</option>
                      <option value="All">All</option>
                      <option value="Whole Blood">Whole Blood</option>
                      <option value="Red Blood Cells">Red Blood Cells</option>
                      <option value="White Blood Cells">
                        White Blood Cells
                      </option>
                      <option value="Platelets">Platelets</option>
                      <option value="Plasma">Plasma</option>
                      <option value="Cryoprecipitate">Cryoprecipitate</option>
                      <option value="Granulocytes">Granulocytes</option>
                    </select>
                  </div>
                </div>
                <button
                  id="generateInventoryReport"
                  class="generateReport bg-secondary"
                  style="right: 363px"
                >
                  Generate Report
                </button>
                <button
                  type="button"
                  class="bloodCompatibilityChecker"
                  style="right: 148px; background-color: #b43929"
                  data-bs-toggle="modal"
                  data-bs-target="#CompatibilityCheckerModal"
                >
                  Blood Compatibility Checker
                </button>
                <button
                  class="addStocks"
                  style="cursor: pointer"
                  data-bs-toggle="modal"
                  data-bs-target="#inventoryModal"
                >
                  Add new stocks
                </button>
              </div>

              <div>
                <div
                  class="d-flex inventory-head shadow-sm"
                  style="
                    background-color: #b43929 !important;
                    border-radius: 10px;
                  "
                >
                  <div class="inventory-body fw-bold text-white">
                    Blood Type
                  </div>
                  <div class="inventory-body fw-bold text-white">Rh factor</div>
                  <div class="inventory-body fw-bold text-white">Component</div>
                  <div class="inventory-body fw-bold text-white">Units</div>
                  <div class="inventory-body fw-bold text-white">Action</div>
                </div>

                <div id="blood_stocks"></div>
                <div class="d-flex justify-content-center mt-3">
                  <nav aria-label="Page navigation example">
                    <ul class="pagination" id="pages"></ul>
                  </nav>
                </div>
              </div>
            </div>
            <div
              class="col-2 bg-white p-3 ms-3 rounded-3 shadow-sm alerts"
              style="width: 250px; position: relative; height: fit-content"
            >
              <span
                class="fw-bold font-size mt-1 mb-3 justify-content-center d-flex align-items-center"
                >Alert Low Stocks
              </span>
              <div
                class="mt-1"
                style="overflow-x: hidden; overflow-y: auto; max-height: 500px"
              >
                <div id="alerts"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Inventory Modal -->
    <div
      class="modal fade"
      id="inventoryModal"
      tabindex="-1"
      aria-labelledby="inventoryModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-sm">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="inventoryModalLabel">
              Add Blood Stocks
            </h5>
          </div>
          <div class="modal-body">
            <form id="inventory_form">
              <input type="hidden" id="user_id" name="user_id" />
              <div class="form-floating mb-3">
                <select
                  class="form-select form-control"
                  id="bloodTypes"
                  name="blood_type"
                  required
                >
                  <option selected disabled>Select types of Blood</option>
                  <option value="O">O</option>
                  <option value="A">A</option>
                  <option value="B">B</option>
                  <option value="AB">AB</option>
                </select>
                <label for="rhFactor">Types of Blood</label>
              </div>
              <div class="form-floating mb-3">
                <select
                  class="form-select form-control"
                  id="rhFactor"
                  name="rh_factor"
                  required
                >
                  <option selected disabled>Select types of Rh factor</option>
                  <option value="+">+</option>
                  <option value="-">-</option>
                </select>
                <label for="rhFactor">Types of Rh Factor</label>
              </div>
              <div class="form-floating mb-3">
                <select
                  class="form-select form-control"
                  id="component"
                  name="component"
                  required
                >
                  <option selected disabled>Select types of Component</option>
                  <option value="Whole Blood">Whole Blood</option>
                  <option value="Red Blood Cells">Red Blood Cells</option>
                  <option value="White Blood Cells">White Blood Cells</option>
                  <option value="Platelets">Platelets</option>
                  <option value="Plasma">Plasma</option>
                  <option value="Cryoprecipitate">Cryoprecipitate</option>
                  <option value="Granulocytes">Granulocytes</option>
                </select>
                <label for="component">Types of Components</label>
              </div>
              <div class="form-floating mb-3">
                <input
                  type="number"
                  class="form-control"
                  id="units"
                  name="avail_blood_units"
                  placeholder="Units"
                  required
                />
                <label for="units">Units</label>
              </div>
              <hr />
              <div class="d-flex align-items-end justify-content-end">
                <button
                  type="submit"
                  id="add"
                  class="button1 me-2 add d-flex align-items-center justify-content-center"
                  style="font-size: 16px"
                >
                  Add
                </button>
                <button
                  type="button"
                  id="modal_close"
                  class="buttonBack modal_close"
                  data-bs-dismiss="modal"
                  style="font-size: 16px"
                >
                  Close
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Inventory Modal -->

    <div
      class="modal fade"
      id="CompatibilityCheckerModal"
      tabindex="-1"
      aria-labelledby="CompatibilityCheckerModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg modal-dialog-scrollable">
        <div class="modal-content">
          <div class="modal-header">
            <div id="CompatibilityCheckerModalLabel">
              <span class="fw-bold fs-5">Blood Compatibility Checker</span>
              <br />
            </div>
            <!-- Trigger button for modal -->
            <button
              type="button"
              id="modalButton"
              style="
                padding: 3px 7px 3px 7px;
                background-color: #b43929;
                border: 2px solid white !important;
                border-radius: 50%;
              "
              data-bs-toggle="modal"
              data-bs-target="#compatibilityModal"
            >
              <img
                src="assets/icon/question-sign (1).png"
                alt=""
                width="15px"
                height="15px"
              />
            </button>
          </div>
          <div class="modal-body px-4">
            <form id="blood_compatibility_form">
              <div class="d-flex">
                <div
                  class="form-floating mb-3 flex-grow-1 me-2"
                  style="width: fit-content"
                >
                  <select class="form-select" id="blood_type" name="blood_type">
                    <option value="O-">O-</option>
                    <option value="O+">O+</option>
                    <option value="A-">A-</option>
                    <option value="A+">A+</option>
                    <option value="B-">B-</option>
                    <option value="B+">B+</option>
                    <option value="AB-">AB-</option>
                    <option value="AB+">AB+</option>
                  </select>
                  <label for="blood_type">Select blood type</label>
                </div>
                <div
                  class="form-floating mb-3 flex-grow-1 me-2"
                  style="width: fit-content"
                >
                  <select class="form-select" id="action" name="action">
                    <option value="donate">Donate</option>
                    <option value="receive">Receive</option>
                  </select>
                  <label for="blood_type">Select action</label>
                </div>
                <div>
                  <button
                    type="submit"
                    class="btn p-3 bg-secondary"
                    style="color: white"
                  >
                    Search
                  </button>
                </div>
              </div>
            </form>

            <div class="p-3 rounded-3">
              <div class="d-flex">
                <span class="fw-bold font-size d-flex ms-2 mb-2">
                  Available stocks</span
                >
              </div>
              <div
                class="d-flex shadow-sm mt-2 bg-secondary"
                style="font-weight: bold; color: white; border-radius: 10px"
              >
                <div class="has-body flex-grow-1">Blood type</div>
                <div class="has-body flex-grow-1">Component</div>
                <div class="has-body flex-grow-1">Units</div>
              </div>
              <div id="inventory"></div>
            </div>
            <div class="p-3 mt-3 rounded-3" id="donorCompatibility">
              <div class="d-flex">
                <span class="fw-bold font-size d-flex ms-2 mb-2">
                  Compatible Donors</span
                >
              </div>
              <div
                class="d-flex shadow-sm mt-2 bg-secondary"
                style="font-weight: bold; color: white; border-radius: 10px"
              >
                <div class="has-body flex-grow-1">Name</div>
                <div class="has-body flex-grow-1">Blood type</div>
                <div class="has-body flex-grow-1">Address</div>
                <div class="has-body flex-grow-1">Phone number</div>
                <div class="has-body flex-grow-1">status</div>
              </div>
              <div id="donors"></div>
            </div>
          </div>
          <div class="modal-footer">
            <div class="d-flex justify-content-end">
              <button
                type="button"
                class="buttonBack modal_close"
                data-bs-dismiss="modal"
              >
                Close
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal -->
    <div
      class="modal fade"
      id="compatibilityModal"
      tabindex="-1"
      aria-labelledby="compatibilityModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="compatibilityModalLabel">
              Blood Type Compatibility
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <div class="row">
              <div class="col-6">
                <h5>Donation</h5>
              </div>
              <div class="col-6">
                <h5>Receive</h5>
              </div>
            </div>

            <!-- Red Blood Cells -->
            <div class="row mb-2">
              <div
                class="col-6"
                style="
                  background-color: #e0f7fa;
                  padding: 10px;
                  border-radius: 5px;
                "
              >
                <strong>Red Blood Cells:</strong><br />
                <strong>O-</strong>: Can donate to: O-, O+, A-, A+, B-, B+, AB-,
                AB+<br />
                <strong>O+</strong>: Can donate to: O+, A+, B+, AB+<br />
                <strong>A-</strong>: Can donate to: A-, A+, AB-, AB+<br />
                <strong>A+</strong>: Can donate to: A+, AB+<br />
                <strong>B-</strong>: Can donate to: B-, B+, AB-, AB+<br />
                <strong>B+</strong>: Can donate to: B+, AB+<br />
                <strong>AB-</strong>: Can donate to: AB-, AB+<br />
                <strong>AB+</strong>: Can donate to: AB+
              </div>
              <div
                class="col-6"
                style="
                  background-color: #ffebee;
                  padding: 10px;
                  border-radius: 5px;
                "
              >
                <strong>Red Blood Cells:</strong><br />
                <strong>O-</strong>: Can receive from: O-<br />
                <strong>O+</strong>: Can receive from: O-, O+<br />
                <strong>A-</strong>: Can receive from: A-, O-<br />
                <strong>A+</strong>: Can receive from: A+, A-, O+, O-<br />
                <strong>B-</strong>: Can receive from: B-, O-<br />
                <strong>B+</strong>: Can receive from: B+, B-, O+, O-<br />
                <strong>AB-</strong>: Can receive from: AB-, B-, O-, A-<br />
                <strong>AB+</strong>: Can receive from: All blood types (O+, O-,
                A+, A-, B+, B-, AB+, AB-)
              </div>
            </div>

            <!-- Plasma -->
            <div class="row mb-2">
              <div
                class="col-6"
                style="
                  background-color: #e0f7fa;
                  padding: 10px;
                  border-radius: 5px;
                "
              >
                <strong>Plasma:</strong><br />
                <strong>AB+</strong>: Can donate to: AB+, AB-, A+, A-, B+, B-,
                O+, O-<br />
                <strong>AB-</strong>: Can donate to: AB-, A-, B-, O-<br />
              </div>
              <div
                class="col-6"
                style="
                  background-color: #ffebee;
                  padding: 10px;
                  border-radius: 5px;
                "
              >
                <strong>Plasma:</strong><br />
                <strong>O-</strong>: Can receive from: O-, O+, A-, A+, B-, B+,
                AB-, AB+<br />
                <strong>A-</strong>: Can receive from: A-, A+, AB-, AB+<br />
                <strong>B-</strong>: Can receive from: B-, B+, AB-, AB+<br />
                <strong>AB-</strong>: Can receive from: AB-, AB+<br />
                <strong>AB+</strong>: Can receive from: AB+
              </div>
            </div>

            <!-- Platelets -->
            <div class="row mb-2">
              <div
                class="col-6"
                style="
                  background-color: #e0f7fa;
                  padding: 10px;
                  border-radius: 5px;
                "
              >
                <strong>Platelets:</strong><br />
                <strong>A+</strong>: Can donate to: A+, AB+<br />
                <strong>B+</strong>: Can donate to: B+, AB+<br />
                <strong>AB+</strong>: Can donate to: AB+<br />
                <strong>O+</strong>: Can donate to: O+, A+, B+, AB+
              </div>
              <div
                class="col-6"
                style="
                  background-color: #ffebee;
                  padding: 10px;
                  border-radius: 5px;
                "
              >
                <strong>Platelets:</strong><br />
                <strong>O-</strong>: Can receive from: O-, O+, A-, A+, B-, B+,
                AB-, AB+<br />
                <strong>A-</strong>: Can receive from: A-, A+, AB-, AB+<br />
                <strong>B-</strong>: Can receive from: B-, B+, AB-, AB+<br />
                <strong>AB-</strong>: Can receive from: AB-, AB+<br />
                <strong>AB+</strong>: Can receive from: AB+
              </div>
            </div>

            <!-- Cryoprecipitate -->
            <div class="row mb-2">
              <div
                class="col-6"
                style="
                  background-color: #e0f7fa;
                  padding: 10px;
                  border-radius: 5px;
                "
              >
                <strong>Cryoprecipitate:</strong><br />
                <strong>AB+</strong>: Can donate to: AB+<br />
                <strong>AB-</strong>: Can donate to: AB-, AB+<br />
                <strong>A+</strong>: Can donate to: A+, AB+<br />
                <strong>B+</strong>: Can donate to: B+, AB+
              </div>
              <div
                class="col-6"
                style="
                  background-color: #ffebee;
                  padding: 10px;
                  border-radius: 5px;
                "
              >
                <strong>Cryoprecipitate:</strong><br />
                <strong>O-</strong>: Can receive from: O-, O+, A-, A+, B-, B+,
                AB-, AB+<br />
                <strong>A-</strong>: Can receive from: A-, A+, AB-, AB+<br />
                <strong>B-</strong>: Can receive from: B-, B+, AB-, AB+<br />
                <strong>AB-</strong>: Can receive from: AB-, AB+<br />
                <strong>AB+</strong>: Can receive from: AB+
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        var popoverTriggerList = [].slice.call(
          document.querySelectorAll('[data-bs-toggle="popover"]')
        );
        var popoverList = popoverTriggerList.map(function (popoverTriggerEl) {
          return new bootstrap.Popover(popoverTriggerEl);
        });
      });

      if (localStorage.getItem("type") === "Hospital") {
        document.getElementById("donorCompatibility").classList.add("d-none");
      }
    </script>
    <script type="module" src="js/router/router.js"></script>
  </body>
</html>
